<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Financeiro - Grid</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" onerror="this.onerror=null;this.href='css/bootstrap.min.css';">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" onerror="this.onerror=null;this.href='css/bootstrap-icons.css';">
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        .floating-editor { position: fixed; display: none; background: #fff; border: 1px solid #ccc; box-shadow: 0 4px 12px rgba(0,0,0,0.25); padding: 12px; border-radius: 6px; z-index: 9999; min-width: 250px; }
        .no-select { user-select: none; }
        .table-accounts th { background-color: #f8f9fa; position: sticky; top: 0; z-index: 10; }
        .flow-selector-container { border: 2px solid #0d6efd; border-radius: 5px; padding: 2px; background: white; margin-right: 10px; }
        .flow-selector { border: none; font-weight: bold; color: #0d6efd; outline: none; padding: 2px 5px; }
        .color-picker-wrapper { width: 25px; height: 25px; border-radius: 50%; overflow: hidden; display: inline-block; vertical-align: middle; border: 2px solid #ccc; cursor: pointer; padding: 0; }
        .color-picker-input { width: 150%; height: 150%; margin: -25%; border: none; padding: 0; cursor: pointer; }
        #configTabsSortable .nav-link { cursor: grab; }
        #configTabsSortable .nav-link:active { cursor: grabbing; }
    </style>
</head>
<body data-theme="excel" style="visibility: hidden;">

    <div id="loadingOverlay"><div class="spinner-border mb-2"></div><div>Carregando...</div></div>

    <div id="styleEditor" class="floating-editor"><div class="d-flex justify-content-between align-items-center mb-2"><span class="small fw-bold">üé® Personalizar</span><button class="btn btn-sm btn-link text-danger p-0" onclick="window.actions.resetStyle()">Limpar</button></div><div class="row g-1 mb-3"><div class="col-6"><input type="color" id="styleBgPicker" class="form-control form-control-color w-100"></div><div class="col-6"><input type="color" id="styleTextPicker" class="form-control form-control-color w-100"></div></div><div class="d-grid gap-1"><button class="btn btn-sm btn-primary" onclick="window.actions.saveStyle()">Aplicar</button><button class="btn btn-sm btn-secondary" onclick="document.getElementById('styleEditor').style.display='none'">Fechar</button></div></div>
    <div id="rowColorEditor" class="floating-editor" style="width: 200px;"><div class="d-flex justify-content-between align-items-center mb-2"><span class="small fw-bold"><i class="bi bi-palette"></i> Cor da Linha</span><button class="btn btn-sm btn-link text-danger p-0" onclick="window.actions.resetRowColor()" title="Remover Cor"><i class="bi bi-eraser-fill"></i></button></div><input type="color" id="rowColorPicker" class="form-control form-control-color w-100 mb-2" value="#ffffff"><div class="d-grid gap-1"><button class="btn btn-sm btn-success" onclick="window.actions.saveRowColor()">Salvar</button><button class="btn btn-sm btn-outline-danger" onclick="window.actions.resetRowColor()">Voltar ao Padr√£o</button><button class="btn btn-sm btn-secondary" onclick="document.getElementById('rowColorEditor').style.display='none'">Cancelar</button></div></div>
    <div id="percentEditor" class="floating-editor" style="width: 180px;"><label class="small fw-bold mb-1">% Conclu√≠do</label><div class="input-group input-group-sm mb-2"><input type="number" id="floatPercentInput" class="form-control" min="0" max="100"><span class="input-group-text">%</span></div><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('percentEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.savePercentEditor()">OK</button></div></div>
    <div id="tagEditor" class="floating-editor" style="width: 260px;"><div id="editorTagList" class="tag-list-editor mb-2"></div><input type="text" id="newTagInput" class="form-control form-control-sm mb-2" placeholder="Nova tag..."><div class="color-dots mb-2 d-flex align-items-center"><div class="color-dot selected" style="background:#ffc107" onclick="window.actions.selectColor('#ffc107', event)"></div><div class="color-dot" style="background:#dc3545" onclick="window.actions.selectColor('#dc3545', event)"></div><div class="color-dot" style="background:#0d6efd" onclick="window.actions.selectColor('#0d6efd', event)"></div><div class="color-dot" style="background:#198754" onclick="window.actions.selectColor('#198754', event)"></div><div class="color-dot" style="background:#6c757d" onclick="window.actions.selectColor('#6c757d', event)"></div><div class="color-picker-wrapper ms-1" title="Outra cor"><input type="color" class="color-picker-input" onchange="window.actions.selectColor(this.value, null)"></div></div><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('tagEditor').style.display='none'">X</button><button class="btn btn-sm btn-primary" onclick="window.actions.addTagFromEditor()">Add</button><button class="btn btn-sm btn-success" onclick="window.actions.saveTagEditor()">OK</button></div></div>
    <div id="dateEditor" class="floating-editor"><div class="input-group input-group-sm mb-2"><input type="text" id="floatDateInput" class="form-control date-mask"><button class="btn btn-outline-secondary" onclick="document.getElementById('floatDatePicker').showPicker()"><i class="bi bi-calendar"></i></button><input type="date" id="floatDatePicker" style="visibility:hidden; position:absolute;" onchange="window.actions.syncDate('floatDateInput', this.value)"></div><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('dateEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveDateEditor()">Salvar</button></div></div>
    <div id="statusEditor" class="floating-editor"><select id="floatStatusInput" class="form-select form-select-sm mb-2"></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('statusEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveStatusEditor()">Salvar</button></div></div>
    <div id="priorityEditor" class="floating-editor"><label class="small fw-bold mb-1">Definir Prioridade</label><select id="floatPriorityInput" class="form-select form-select-sm mb-2"><option value="Alta">Alta</option><option value="M√©dia">M√©dia</option><option value="Baixa">Baixa</option></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('priorityEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.savePriorityEditor()">Salvar</button></div></div>
    <div id="bankGridEditor" class="floating-editor"><label class="small fw-bold mb-1" id="bankGridLabel">Editar</label><div class="input-group input-group-sm mb-2"><input type="text" id="bankGridInput" class="form-control" list="bankGridList" autocomplete="off" placeholder="Selecione..."><button class="btn btn-outline-secondary" type="button" onclick="document.getElementById('bankGridInput').value=''; document.getElementById('bankGridInput').focus();" title="Limpar"><i class="bi bi-x-lg"></i></button></div><datalist id="bankGridList"></datalist><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('bankGridEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveBankGridEditor()">Salvar</button></div></div>
    <div id="flowEditor" class="floating-editor"><label class="small fw-bold mb-1">Tipo de Fluxo</label><select id="floatFlowInput" class="form-select form-select-sm mb-2"><option value="Contas a Pagar">Contas a Pagar</option><option value="Contas a Receber">Contas a Receber</option></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('flowEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveFlowEditor()">Salvar</button></div></div>
    <div id="modalidadeEditor" class="floating-editor"><label class="small fw-bold mb-1">Modalidade</label><select id="floatModalidadeInput" class="form-select form-select-sm mb-2"></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('modalidadeEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveModalidadeEditor()">Salvar</button></div></div>
    <div id="ocorrenciaEditor" class="floating-editor"><label class="small fw-bold mb-1">Ocorr√™ncia</label><select id="floatOcorrenciaInput" class="form-select form-select-sm mb-2"></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('ocorrenciaEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveOcorrenciaEditor()">Salvar</button></div></div>
    <div id="fileTypeEditor" class="floating-editor"><label class="small fw-bold mb-1">Tipo de Arquivo</label><select id="floatFileTypeInput" class="form-select form-select-sm mb-2"></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('fileTypeEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveFileTypeEditor()">Salvar</button></div></div>
    <div id="methodEditor" class="floating-editor"><label class="small fw-bold mb-1">M√©todo</label><select id="floatMethodInput" class="form-select form-select-sm mb-2"></select><div class="d-flex justify-content-end gap-1"><button class="btn btn-sm btn-outline-secondary" onclick="document.getElementById('methodEditor').style.display='none'">Cancelar</button><button class="btn btn-sm btn-success" onclick="window.actions.saveMethodEditor()">Salvar</button></div></div>

    <div class="toolbar" style="height: auto; flex-wrap: wrap; padding: 5px 15px;">
        <div class="d-flex align-items-center gap-2 flex-wrap">
            <div class="flow-selector-container">
                <i class="bi bi-arrow-left-right text-primary ms-1"></i>
                <select id="globalFlowSelector" class="flow-selector" onchange="window.actions.changeGlobalFlow(this.value)"><option value="Contas a Pagar" selected>CONTAS A PAGAR</option><option value="Contas a Receber">CONTAS A RECEBER</option></select>
            </div>
            <div style="width:1px; height:20px; background:rgba(255,255,255,0.3); margin:0 5px;"></div>
            
            <input type="file" id="fileInput" accept=".csv" hidden onchange="window.actions.iniciarImportacao(this)">
            <button class="btn-tool btn-import-grid" onclick="document.getElementById('fileInput').click()"><i class="bi bi-folder2-open"></i> Importar</button>
            <button class="btn-tool fw-bold text-warning btn-save-grid" onclick="window.actions.salvarManual()"><i class="bi bi-save"></i> Salvar</button>
            <div style="width:1px; height:20px; background:rgba(255,255,255,0.3); margin:0 5px;"></div>
            <button class="btn-tool fw-bold btn-new-grid" onclick="window.actions.abrirModalNovoPai()"><i class="bi bi-plus-circle"></i> Novo</button>
            
            <div style="width:1px; height:20px; background:rgba(255,255,255,0.3); margin:0 15px;"></div>
            
            <a href="kanban.html" target="_blank" class="btn-tool text-white fw-bold text-decoration-none border-white"><i class="bi bi-kanban"></i> Kanban</a>
            <a href="gantt.html" target="_blank" class="btn-tool text-white fw-bold text-decoration-none border-white ms-2"><i class="bi bi-bar-chart-steps"></i> Gantt</a>
            <a href="dashboard.html" target="_blank" class="btn-tool text-info fw-bold text-decoration-none border-info ms-2 btn-dashboard-link"><i class="bi bi-pie-chart-fill"></i> Dashboard</a>
        </div>
        
        <div class="d-flex align-items-center gap-2 ms-auto">
            <button class="btn-tool" onclick="window.actions.abrirConfigStatus()"><i class="bi bi-gear-wide-connected"></i> Configura√ß√µes</button>
            <select class="tool-select" id="encodingSelector"><option value="UTF-8">UTF-8</option><option value="ISO-8859-1">Latin1</option></select>
            <select class="tool-select" onchange="window.actions.mudarTema(this.value)" id="themeSelector"><option value="excel">üé® Excel</option><option value="light">‚òÄÔ∏è Light</option><option value="dark">üåô Dark</option></select>
            <button class="btn-tool text-danger" onclick="window.actions.logout()"><i class="bi bi-box-arrow-right"></i> Sair</button>
        </div>
    </div>

    <div class="main-content" style="height: calc(100vh - 60px);">
        <div class="spreadsheet-container h-100">
            <table class="table-excel">
                <thead id="grid-header"></thead>
                <tbody id="tabela-corpo"></tbody>
            </table>
        </div>
    </div>

    <div class="modal fade" id="modalReg" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header py-2"><h5 class="modal-title fw-bold">Editor</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><input type="hidden" id="idxP"> <input type="hidden" id="idxC"><div class="row g-2 mb-2"><div class="col-md-2"><label class="small fw-bold">SEQ</label><input id="inp_id" class="form-control form-control-sm"></div><div class="col-md-5"><label class="small fw-bold">Empresa</label><input id="inp_empresa" class="form-control form-control-sm" list="list_empresa" autocomplete="off" placeholder="Selecione..."><datalist id="list_empresa"></datalist></div><div class="col-md-5"><label class="small fw-bold">Respons√°vel</label><input id="inp_responsavel" class="form-control form-control-sm"></div></div><div class="row g-2 mb-2 bg-light p-2 rounded border"><div class="col-md-3"><label class="small fw-bold">Banco</label><input id="inp_banco" class="form-control form-control-sm" list="list_banco" autocomplete="off" placeholder="Selecione..."><datalist id="list_banco"></datalist></div><div class="col-md-2"><label class="small fw-bold">N¬∫ Banco</label><input id="inp_num_banco" class="form-control form-control-sm" list="list_num_banco" autocomplete="off" placeholder="N¬∫..."><datalist id="list_num_banco"></datalist></div><div class="col-md-2"><label class="small fw-bold">AG</label><input id="inp_agencia" class="form-control form-control-sm" list="list_agencia" autocomplete="off" placeholder="Selecione..."><datalist id="list_agencia"></datalist></div><div class="col-md-3"><label class="small fw-bold">Conta</label><input id="inp_conta" class="form-control form-control-sm" list="list_conta" autocomplete="off" placeholder="Selecione..."><datalist id="list_conta"></datalist></div><div class="col-md-2"><label class="small fw-bold">C√≥d/Chamado</label><input id="inp_cod" class="form-control form-control-sm"></div></div><div class="row g-2 mb-2"><div class="col-md-3"><label class="small fw-bold">Modalidade</label><input id="inp_modalidade" class="form-control form-control-sm"></div><div class="col-md-3"><label class="small fw-bold">Tipo Arq</label><input id="inp_tipo_arq" class="form-control form-control-sm"></div><div class="col-md-3"><label class="small fw-bold">M√©todo</label><input id="inp_metodo" class="form-control form-control-sm"></div><div class="col-md-3"><label class="small fw-bold">T√≥pico</label><input id="inp_topico" class="form-control form-control-sm"></div></div><div class="row g-2 mb-2"><div class="col-md-2"><label class="small fw-bold">Prioridade</label><select id="inp_prioridade" class="form-select form-select-sm"><option>Alta</option><option>M√©dia</option><option>Baixa</option></select></div><div class="col-md-3"><label class="small fw-bold">Data Prev.</label><div class="input-group input-group-sm"><input type="text" id="inp_dt_prevista" class="form-control date-mask"><button class="btn btn-outline-secondary" onclick="document.getElementById('picker_dt_prevista').showPicker()"><i class="bi bi-calendar"></i></button><input type="date" id="picker_dt_prevista" style="visibility:hidden; position:absolute;" onchange="window.actions.syncDate('inp_dt_prevista', this.value)"></div></div><div class="col-md-2"><label class="small fw-bold">Data Tram.</label><div class="input-group input-group-sm"><input type="text" id="inp_dt_tramitacao" class="form-control date-mask"><button class="btn btn-outline-secondary" onclick="document.getElementById('picker_dt_tramitacao').showPicker()"><i class="bi bi-calendar"></i></button><input type="date" id="picker_dt_tramitacao" style="visibility:hidden; position:absolute;" onchange="window.actions.syncDate('inp_dt_tramitacao', this.value)"></div></div><div class="col-md-2"><label class="small fw-bold">Data Concl.</label><div class="input-group input-group-sm"><input type="text" id="inp_dt_conclusao" class="form-control date-mask"><button class="btn btn-outline-secondary" onclick="document.getElementById('picker_dt_conclusao').showPicker()"><i class="bi bi-calendar"></i></button><input type="date" id="picker_dt_conclusao" style="visibility:hidden; position:absolute;" onchange="window.actions.syncDate('inp_dt_conclusao', this.value)"></div></div><div class="col-md-2"><label class="small fw-bold">Status</label><select id="inp_status" class="form-select form-select-sm"></select></div><div class="col-md-1"><label class="small fw-bold">%</label><input id="inp_percentual" type="number" class="form-control form-control-sm"></div></div><div class="row g-2"><div class="col-md-12"><label class="small fw-bold mb-1">Tags</label><div class="card p-2"><div id="modalTagList" class="modal-tags-container mb-2 d-flex gap-1 flex-wrap" style="min-height:30px;"></div><div class="d-flex align-items-center gap-2 flex-wrap"><div class="input-group input-group-sm" style="max-width: 250px;"><input type="text" id="modalNewTagInput" class="form-control" placeholder="Nova Tag..."><button class="btn btn-primary" onclick="window.actions.modalAddTag()"><i class="bi bi-plus-lg"></i></button></div><div class="d-flex align-items-center gap-2 ms-2 bg-light p-1 rounded border"><div class="color-dot selected" style="background:#ffc107" onclick="window.actions.modalSelectColor('#ffc107', this)"></div><div class="color-dot" style="background:#dc3545" onclick="window.actions.modalSelectColor('#dc3545', this)"></div><div class="color-dot" style="background:#0d6efd" onclick="window.actions.modalSelectColor('#0d6efd', this)"></div><div class="color-dot" style="background:#198754" onclick="window.actions.modalSelectColor('#198754', this)"></div><div class="color-dot" style="background:#6c757d" onclick="window.actions.modalSelectColor('#6c757d', this)"></div><div class="color-picker-wrapper ms-1" title="Outra cor"><input type="color" class="color-picker-input" onchange="window.actions.modalSelectColor(this.value, null)"></div></div></div></div></div><div class="col-md-6 mt-2"><label class="small fw-bold">Anota√ß√µes</label><textarea id="inp_anotacoes" class="form-control form-control-sm" rows="2"></textarea></div><div class="col-md-6 mt-2"><label class="small fw-bold">Observa√ß√µes</label><textarea id="inp_obs" class="form-control form-control-sm" rows="2"></textarea></div></div></div><div class="modal-footer py-1"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Fechar</button><button type="button" class="btn btn-primary btn-sm" onclick="window.actions.salvarModal()">Salvar Registro</button></div></div></div></div>
    
    <div class="modal fade" id="modalConfigStatus" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header py-2 bg-light"><h5 class="modal-title fw-bold">Configura√ß√£o</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body">
        
        <ul class="nav nav-tabs mb-3" id="configTabsSortable">
            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#conf-status">Colunas Kanban</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-gantt">Gantt</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-cards">Campos Card</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-cols">Colunas Grid</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-finance-modes">Modalidades</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-finance-occ">Ocorr√™ncias</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-file-types">Tipos Arq</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-finance-methods">M√©todos</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-accounts">Contas Banc√°rias</a></li>
            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#conf-sla">SLA</a></li>
            <li class="nav-item" id="tab-header-users"><a class="nav-link" data-bs-toggle="tab" href="#conf-users">Usu√°rios</a></li>
            <li class="nav-item"><a class="nav-link text-danger fw-bold" data-bs-toggle="tab" href="#conf-maintenance">Manuten√ß√£o</a></li>
        </ul>
        
        <div class="tab-content" id="configTabContent">
            
            <div class="tab-pane fade show active" id="conf-status">
                <input type="hidden" id="editStatusIndex" value="-1">
                <div class="row g-2 mb-2 align-items-center p-2 bg-light border rounded">
                    <div class="col-md-4"><label class="small text-muted">Nome</label><input type="text" id="newStatusName" class="form-control form-control-sm"></div>
                    <div class="col-md-2"><label class="small text-muted">WIP</label><input type="number" id="newStatusLimit" class="form-control form-control-sm"></div>
                    <div class="col-md-2"><label class="small text-muted">Fundo</label><input type="color" id="newStatusBg" class="form-control form-control-color w-100" value="#e9ecef"></div>
                    <div class="col-md-2"><label class="small text-muted">Texto</label><input type="color" id="newStatusText" class="form-control form-control-color w-100" value="#000000"></div>
                    <div class="col-md-2 d-flex align-items-end"><button id="btnSaveStatus" class="btn btn-primary btn-sm w-100" onclick="window.actions.saveStatusConfig()">Adicionar</button><button id="btnCancelEdit" class="btn btn-outline-secondary btn-sm ms-1" style="display:none;" onclick="window.actions.cancelEditStatus()">X</button></div>
                </div>
                <ul class="list-group" id="statusConfigList" style="max-height: 400px; overflow-y:auto;"></ul>
            </div>

            <div class="tab-pane fade" id="conf-gantt">
                <div class="card p-4 border-light bg-light">
                    <h6 class="fw-bold mb-3"><i class="bi bi-magic"></i> Previs√£o Autom√°tica</h6>
                    <div class="row align-items-end">
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-muted">Dias para previs√£o</label>
                            <div class="input-group">
                                <input type="number" id="ganttAutoDaysInput" class="form-control" min="1" value="5">
                                <span class="input-group-text">dias</span>
                            </div>
                        </div>
                        <div class="col-md-8"><p class="small text-muted mb-2">Soma √† Data de Tramita√ß√£o se n√£o houver previs√£o.</p></div>
                        <div class="col-12 mt-3 text-end"><button class="btn btn-success fw-bold" onclick="window.actions.saveGanttConfig()">Salvar</button></div>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="conf-cards"><div id="kanbanCardConfigList" class="d-flex flex-column gap-2 mb-3"></div><div class="text-end"><button class="btn btn-primary" onclick="window.actions.saveKanbanCardConfig()">Salvar</button></div></div>
            <div class="tab-pane fade" id="conf-cols"><ul class="list-group" id="colConfigList"></ul></div>
            <div class="tab-pane fade" id="conf-finance-modes"><div class="input-group mb-3"><input type="text" id="newPaymentMode" class="form-control" placeholder="Nova Modalidade"><button class="btn btn-primary" onclick="window.actions.addConfigItem('paymentModes', 'newPaymentMode')">Add</button></div><ul class="list-group" id="listPaymentModes"></ul></div>
            <div class="tab-pane fade" id="conf-finance-occ"><div class="input-group mb-3"><input type="text" id="newOccurrence" class="form-control" placeholder="Nova Ocorr√™ncia"><button class="btn btn-primary" onclick="window.actions.addConfigItem('receivableOccurrences', 'newOccurrence')">Add</button></div><ul class="list-group" id="listOccurrences"></ul></div>
            <div class="tab-pane fade" id="conf-file-types"><div class="input-group mb-3"><input type="text" id="newFileType" class="form-control" placeholder="Novo Tipo"><button class="btn btn-primary" onclick="window.actions.addConfigItem('fileTypes', 'newFileType')">Add</button></div><ul class="list-group" id="listFileTypes"></ul></div>
            <div class="tab-pane fade" id="conf-finance-methods"><div class="input-group mb-3"><input type="text" id="newPaymentMethod" class="form-control" placeholder="Novo M√©todo"><button class="btn btn-primary" onclick="window.actions.addConfigItem('paymentMethods', 'newPaymentMethod')">Add</button></div><ul class="list-group" id="listPaymentMethods"></ul></div>
            <div class="tab-pane fade" id="conf-accounts"><div class="card p-3 mb-3 border-light bg-light"><form id="formAccount" onsubmit="event.preventDefault(); window.actions.saveAccount()"><input type="hidden" id="accId"><div class="row g-2"><div class="col-md-6"><label class="small fw-bold">Nome Oracle</label><input type="text" id="accOracle" class="form-control form-control-sm" required></div><div class="col-md-4"><label class="small fw-bold">Banco</label><input type="text" id="accBank" class="form-control form-control-sm" required></div><div class="col-md-2"><label class="small fw-bold">N¬∫ Banco</label><input type="text" id="accBankNum" class="form-control form-control-sm" required></div><div class="col-md-3"><label class="small fw-bold">Ag√™ncia</label><input type="text" id="accAgency" class="form-control form-control-sm" required></div><div class="col-md-3"><label class="small fw-bold">Conta</label><input type="text" id="accNum" class="form-control form-control-sm" required></div><div class="col-md-6"><label class="small fw-bold">Pessoa Jur√≠dica</label><input type="text" id="accCompany" class="form-control form-control-sm" required></div><div class="col-12 text-end mt-2"><button type="submit" class="btn btn-success btn-sm fw-bold">Salvar</button><button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('formAccount').reset(); document.getElementById('accId').value='';">Limpar</button></div></div></form></div><div class="d-flex justify-content-between align-items-center mb-2"><h6 class="fw-bold mb-0">Contas</h6><div><input type="file" id="csvAccountInput" accept=".csv" hidden onchange="window.actions.preImportAccounts(this)"><button class="btn btn-outline-primary btn-sm" onclick="document.getElementById('csvAccountInput').click()">Importar CSV</button></div></div><div class="table-responsive border rounded" style="max-height: 400px; overflow-y: auto;"><table class="table table-sm table-hover table-bordered small mb-0 table-accounts"><thead class="table-light"><tr><th>Nome Oracle</th><th>Banco</th><th>N¬∫</th><th>Ag/Conta</th><th>Empresa</th><th style="width:80px;">A√ß√µes</th></tr></thead><tbody id="accountsTableBody"></tbody></table></div></div>
            <div class="tab-pane fade" id="conf-sla"><div class="card p-3 mb-3 bg-light border"><label class="small fw-bold mb-2">Adicionar Regra</label><div class="input-group mb-3"><input type="text" id="newSlaResp" class="form-control" placeholder="Respons√°vel"><input type="number" id="newSlaDays" class="form-control" placeholder="Dias"><button class="btn btn-primary" onclick="window.actions.addSlaRule()">Add</button></div></div><ul class="list-group" id="slaList"></ul></div>
            <div class="tab-pane fade" id="conf-users"><div class="card p-3 mb-3 bg-light border"><h6 class="fw-bold">Novo / Editar</h6><input type="hidden" id="editUserId"><div class="row g-2 mb-2"><div class="col-md-6"><label class="small">Usu√°rio</label><input type="text" id="userInputName" class="form-control form-control-sm"></div><div class="col-md-6"><label class="small">Senha</label><input type="password" id="userInputPass" class="form-control form-control-sm"></div></div><label class="small fw-bold mt-2">Permiss√µes</label><div class="row g-2 mb-3"><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_grid_view"><label class="form-check-label small" for="perm_grid_view">Ver Grid</label></div></div><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_grid_edit"><label class="form-check-label small" for="perm_grid_edit">Edt Grid</label></div></div><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_kanban_view"><label class="form-check-label small" for="perm_kanban_view">Ver Kbn</label></div></div><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_kanban_edit"><label class="form-check-label small" for="perm_kanban_edit">Edt Kbn</label></div></div><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_dash_view"><label class="form-check-label small" for="perm_dash_view">Ver Dsh</label></div></div><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_dash_edit"><label class="form-check-label small" for="perm_dash_edit">Edt Dsh</label></div></div><div class="col-3"><div class="form-check"><input type="checkbox" class="form-check-input perm-check" id="perm_admin"><label class="form-check-label small text-danger fw-bold" for="perm_admin">ADMIN</label></div></div></div><button class="btn btn-sm btn-success w-100" onclick="window.actions.saveUser()">Salvar</button></div><ul class="list-group" id="usersList"></ul></div>
            <div class="tab-pane fade" id="conf-maintenance"><div class="alert alert-danger" role="alert"><strong>Aten√ß√£o!</strong> A√ß√£o irrevers√≠vel.</div><div class="text-end"><button class="btn btn-danger fw-bold" onclick="window.actions.clearAllTickets()">ZERAR REGISTROS</button></div></div>
        </div>
    </div><div class="modal-footer py-1"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Fechar</button></div></div></div></div>

    <div class="modal fade" id="modalAccountImportOptions" tabindex="-1" data-bs-backdrop="static"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title fw-bold">Importar Contas</h5></div><div class="modal-body text-center"><div class="d-grid gap-2"><button class="btn btn-danger py-2 fw-bold" onclick="window.actions.confirmImportAccounts('clear')">ZERAR E IMPORTAR</button><button class="btn btn-success py-2 fw-bold" onclick="window.actions.confirmImportAccounts('append')">ADICIONAR</button><button class="btn btn-secondary py-2" data-bs-dismiss="modal" onclick="window.actions.cancelImportAccounts()">Cancelar</button></div></div></div></div></div>
    <div class="modal fade" id="modalImportConfirm" tabindex="-1" data-bs-backdrop="static"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-warning-subtle"><h5 class="modal-title fw-bold">Dados Encontrados</h5></div><div class="modal-body text-center"><div class="d-grid gap-2"><button class="btn btn-danger py-2" onclick="window.actions.executarImportacao('overwrite')">APAGAR TUDO e Inserir</button><button class="btn btn-primary py-2" onclick="window.actions.executarImportacao('append')">ADICIONAR</button><button class="btn btn-secondary py-2" data-bs-dismiss="modal">Cancelar</button></div></div></div></div></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" onerror="this.onerror=null;this.src='js/bootstrap.bundle.min.js';"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js" onerror="this.onerror=null;this.src='js/Sortable.min.js';"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>